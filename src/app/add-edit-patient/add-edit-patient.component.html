<!-- patient.component.html -->
<div class="flex">

    <app-sidebar></app-sidebar>
    <div class="w-full">
        <app-top-strip></app-top-strip>
    <div class="container mx-auto px-4 py-4 h-[90vh] overflow-y-auto">


        <div class="">
            <div class="bg-white w-full max-h-[85vh] overflow-hidden flex flex-col">
                <div class="flex justify-between items-center p-4 border-b">
                    <h1 class="text-2xl font-bold sticky top-0">{{title}}</h1>
                </div>

                <div class="flex-1 overflow-y-auto p-4">
                    <form [formGroup]="patientForm" class="formClass grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Personal Information -->
                        <h2
                            class="font-semibold col-span-full  text-gray-700 text-base md:text-md border-l-[4px] pl-2 border-blue-500">
                            Personal Information
                        </h2>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                            <input type="text" formControlName="fullName"
                                class="w-full px-3 py-2 border rounded-lg text-sm">
                    <span *ngIf="errorMessages['fullName']" class="text-red-500">{{
                                errorMessages["fullName"]
                                }}</span>


                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Date of Birth</label>
                            <input type="date" formControlName="dob" class="w-full px-3 py-2 border rounded-lg text-sm">
                        
                          <span *ngIf="errorMessages['dob']" class="text-red-500">{{
                                errorMessages["dob"]
                                }}</span>
                        
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Gender</label>
                            <select formControlName="gender" class="w-full px-3 py-2 border rounded-lg text-sm">
                                <option value="">Select Gender</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Other">Other</option>
                            </select>


                              <span *ngIf="errorMessages['gender']" class="text-red-500">{{
                                errorMessages["gender"]
                                }}</span>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Blood Group</label>
                            <select formControlName="bloodGroup" class="w-full px-3 py-2 border rounded-lg text-sm">
                                <option value="">Select Blood Group</option>
                                <option *ngFor="let bg of bloodGroups" [value]="bg">{{bg}}</option>
                            </select>


                              <span *ngIf="errorMessages['bloodGroup']" class="text-red-500">{{
                                errorMessages["bloodGroup"]
                                }}</span>

                        </div>

                        <h2
                            class="font-semibold col-span-full  mt-8 text-gray-700 text-base md:text-md border-l-[4px] pl-2 border-blue-500">
                            Contact Details </h2>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Phone</label>
                            <input type="tel" formControlName="phone"
                                class="w-full px-3 py-2 border rounded-lg text-sm">

                            <span *ngIf="errorMessages['phone']" class="text-red-500">{{
                                                            errorMessages["phone"]
                                                            }}</span>

                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                            <input type="email" formControlName="email"
                                class="w-full px-3 py-2 border rounded-lg text-sm">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Address</label>
                            <textarea rows="1" formControlName="address"
                                class="w-full px-3 py-2 border rounded-lg text-sm"></textarea>
                        </div>


                        <!-- Medical Information -->
                        <h2
                            class="font-semibold col-span-full  mt-8 text-gray-700 text-base md:text-md border-l-[4px] pl-2 border-blue-500">
                            Health Information </h2>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Height (cm)</label>
                            <input type="number" formControlName="height"
                                class="w-full px-3 py-2 border rounded-lg text-sm">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Weight (kg)</label>
                            <input type="number" formControlName="weight"
                                class="w-full px-3 py-2 border rounded-lg text-sm">
                        </div>
                        
                        <!-- <div formArrayName="allergies">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Allergies</label>
                            <div *ngFor="let allergy of allergies.controls; let i = index" class="flex gap-2 mb-2">
                                <input [formControlName]="i" class="flex-1 px-3 py-2 border rounded-lg text-sm">
                                <button type="button" (click)="removeAllergy(i)"
                                    class="text-red-500 hover:text-red-700">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <button type="button" (click)="addAllergy()"
                                class="text-sm text-blue-500 hover:text-blue-700">
                                + Add Allergy
                            </button>
                        </div> -->

                        <!-- <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Past Medical History</label>
                             <div *ngFor="let allergy of pastMedicalHistory.controls; let i = index"
                                class="flex gap-2 mb-2">
                                <input [formControlName]="i" class="flex-1 px-3 py-2 border rounded-lg text-sm">
                                <button type="button" (click)="removeMedicalHistory(i)"
                                    class="text-red-500 hover:text-red-700">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <button type="button" (click)="addMedicalHistory()"
                                class="text-sm text-blue-500 hover:text-blue-700">
                                + Add History
                            </button>
                        </div> -->

                        <!-- Visit Information -->
                        <!-- <h2
                            class="font-semibold col-span-full  mt-8 text-gray-700 text-base md:text-md border-l-[4px] pl-2 border-blue-500">
                            Appointment Details </h2>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Visit Date & Time</label>
                            <input type="datetime-local" formControlName="visitDateTime"
                                class="w-full px-3 py-2 border rounded-lg text-sm">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Reason for Visit</label>
                            <textarea rows="1" formControlName="reasonForVisit"
                                class="w-full px-3 py-2 border rounded-lg text-sm"></textarea>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Diagnosis</label>
                            <textarea rows="1" formControlName="diagnosis"
                                class="w-full px-3 py-2 border rounded-lg text-sm"></textarea>
                        </div> -->


                        <h2>Patient Health Description</h2>
                        <div class="col-span-full">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                            <textarea rows="4" formControlName="description"
                                class="w-full px-3 py-2 border rounded-lg text-sm"></textarea>
                                </div>
                        <!-- Form Actions -->
                        <div class="col-span-full flex justify-end space-x-3 mt-4">
                            <button type="submit" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg" (click)="AddUpdatePatient()">
                                {{ !patientId ? 'Add Patient' : 'Save Changes' }}
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
